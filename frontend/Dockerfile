FROM node:18-alpine

WORKDIR /app

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
ARG API_URL=http://192.168.56.20/api
ARG GOOGLE_AUTH_CLIENT_ID=648253380231-u9r6ak5ui2mve6sl4eu5qf48v1dp03l9.apps.googleusercontent.com

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬ (í•„ìš”í•œ íŒŒì¼ë§Œ)
COPY css/ ./css/
COPY js/ ./js/
COPY index.html ./

# js/config.js íŒŒì¼ ìƒì„± (í™˜ê²½ë³€ìˆ˜ë¡œ)
RUN mkdir -p js && \
    echo "// ìë™ ìƒì„±ëœ í™˜ê²½ì„¤ì • íŒŒì¼" > js/config.js && \
    echo "window.ENV = {" >> js/config.js && \
    echo "    GOOGLE_AUTH_CLIENT_ID: \"${GOOGLE_AUTH_CLIENT_ID}\"," >> js/config.js && \
    echo "    API_URL: \"${API_URL}\"" >> js/config.js && \
    echo "};" >> js/config.js && \
    echo "console.log('ğŸ”§ í™˜ê²½ë³€ìˆ˜ ë¡œë“œë¨:', window.ENV);" >> js/config.js

# http-server ì„¤ì¹˜
RUN npm install -g http-server

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 3000

# ì„œë²„ ì‹¤í–‰
CMD ["http-server", ".", "-p", "3000", "-a", "0.0.0.0", "--cors"]